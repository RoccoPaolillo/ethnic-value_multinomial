knitr::opts_chunk$set(echo = TRUE, fig.lp="fig:",warning = FALSE)
# install.packages("tinytex", repos = "https://cloud.r-project.org" )
library(tidyverse)
library(ggplot2)
library(gridExtra)
library(tidyr)
library(plyr)
library(dplyr)
# Beta distribution parameters mean and standard deviation
# https://stats.stackexchange.com/questions/12232/calculating-the-parameters-of-a-beta-distribution-using-the-mean-and-variance
f_spk <- function(i_e,x,n){      # utility function as single-peaked
if (x > n){
U <- NA}else{
if (x < (n*i_e)){
U <- (x / (n*i_e))
}else if (x > (n*i_e)){
U <- i_e + (((1- (x/n))*(1-i_e))/(1-i_e))
}else{
U <- 1}
round(U,digits = 3)
}
}
f_thr <- function(i_e,x,n){  # to plot threshold function
if (x >= (n*i_e)){
U <- 1}else{
U <- 0 }
}
# install.packages("tinytex", repos = "https://cloud.r-project.org" ) #, try if debug needed
knitr::include_graphics("C:/Users/rocpa/OneDrive/Desktop/AF/ethnic-value_multinomial/material/model_pr.jpg")
setwd("C:/Users/rocpa/OneDrive/Desktop/AF/ethnic-value_multinomial/material/beta-diff/")
a <- read.csv("beta-et.csv",sep = ",",skip = 6)
names(a)[names(a) == "mean..count..turtles.on.neighbors..with..ethnicity....ethnicity..of.myself....count..turtles.on.neighbors....of.turtles.with..count..turtles.on.neighbors.....1." ] <- "eth_seg"
a %>% filter(ticks == 0  | ticks == 500  | ticks == 100 | ticks == 1000)  %>%  filter(beta.ie >= 0 & beta.ie <= 30) %>% ggplot(aes(x = beta.ie, y = eth_seg)) + geom_bar(stat="identity") + facet_wrap(~ ticks, labeller = label_both)
setwd("C:/Users/rocpa/OneDrive/Desktop/AF/ethnic-value_multinomial/material/beta-diff/")
b  <-  read.csv("beta-et-vl.csv",sep = ",",skip = 6)
names(b)[names(b) == "mean..count..turtles.on.neighbors..with..ethnicity....ethnicity..of.myself....count..turtles.on.neighbors...of.turtles.with..count..turtles.on.neighbors.....1." ] <- "eth_seg"
names(b)[names(b) == "mean..count..turtles.on.neighbors..with..shape....shape..of.myself....count..turtles.on.neighbors...of.turtles.with..count..turtles.on.neighbors.....1."] <- "val_seg"
c  <- b %>% filter(beta.ie >= beta.iv )
diff_ev <- c$beta.ie - c$beta.iv
c  <- cbind(c,diff_ev)
c %>%  filter(ticks == 1000)  %>% ggplot(aes(x = beta.ie, y = eth_seg)) + geom_bar(stat = "identity") + facet_wrap(~  beta.iv, labeller = label_both)
